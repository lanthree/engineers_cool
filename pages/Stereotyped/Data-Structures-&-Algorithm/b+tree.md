# B+树

## 定义

基于B树的定义上，有以下修改：
1. 数据项存储在叶子上
2. 有M个子树的中间节点包含有M个元素（B树中是M-1个元素），每个元素不保存数据，只用来索引，所有数据都保存在叶子节点
3. 所有的中间节点元素都同时存在于子节点，在子节点元素中是最大（或最小）元素。（以下以最小为例）
4. 所有的叶子结点中包含了全部元素的信息，及指向含这些元素记录的指针，且叶子结点本身依关键字的大小自小而大顺序链接
5. 平级结点间通过双向链表相连

一个可能的3阶B+树如下：

![](https://engineers-cool-1251518258.cos.ap-chengdu.myqcloud.com/3Bptree.png)


单个数据项的查找过程类似于B树，而且磁盘读取次数更稳定（B树因内部结点有数据项，可能提前结束，也可能因为数据项过大，多次磁盘读取才能找其子结点）。

另外，因为B\+的平级结点间通过双向链表相连，所以范围查找具有更好的性能（B树需要多次递归），例如下图查找19到37所有值的过程：

![从上向下找到19所在的叶子后，可以直接向右找到下一个叶子](https://engineers-cool-1251518258.cos.ap-chengdu.myqcloud.com/3Bpstree_scan.png)


## 插入/删除

插入/删除过程与B树基本一致。（笑）

## 参考

1. [漫画：什么是B+树？](https://zhuanlan.zhihu.com/p/54102723)
2. [wikipedia B+树](https://zh.wikipedia.org/wiki/B%2B%E6%A0%91)
3. [再有人问你为什么MySQL用B+树做索引，就把这篇文章发给她](https://mp.weixin.qq.com/s/8nx4yLOg542p_fmqjKDrKw)
